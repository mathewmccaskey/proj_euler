c-------------------------------------------------------------------------------------------------c
      program project_euler_101
c-------------------------------------------------------------------------------------------------c
c                                                                                                 c
c  If we are presented with the first k terms of a sequence it is impossible to say with          c
c  certainty the value of the next term, as there are infinitely many polynomial functions that   c
c  can model the sequence.                                                                        c
c                                                                                                 c
c  As an example, let us consider the sequence of cube numbers. This is defined by the generating c
c  function, u_n = n^3: 1, 8, 27, 64, 125, 216, ...                                               c
c                                                                                                 c
c  Suppose we were only given the first two terms of this sequence. Working on the principle that c
c  "simple is best" we should assume a linear relationship and predict the next term to be 15     c
c  (common difference 7). Even if we were presented with the first three terms, by the same       c
c  principle of simplicity, a quadratic relationship should be assumed.                           c
c                                                                                                 c
c  We shall define OP(k, n) to be the nth term of the optimum polynomial generating function for  c
c  the first k terms of a sequence. It should be clear that OP(k, n) will accurately generate the c
c  terms of the sequence for n ≤ k, and potentially the first incorrect term (FIT) will be        c
c  OP(k, k+1); in which case we shall call it a bad OP (BOP).                                     c
c                                                                                                 c
c  As a basis, if we were only given the first term of sequence, it would be most sensible to     c
c  assume constancy; that is, for n ≥ 2, OP(1, n) = u_1.                                          c
c                                                                                                 c
c  Hence we obtain the following OPs for the cubic sequence:                                      c
c  OP(1, n) = 1                 1, 1, 1, 1, ...                                                   c
c  OP(2, n) = 7n−6              1, 8, 15, ...                                                     c
c  OP(3, n) = 6n^2−11n+6        1, 8, 27, 58, ...                                                 c
c  OP(4, n) = n^3               1, 8, 27, 64, 125, ...                                            c
c                                                                                                 c
c  Clearly no BOPs exist for k ≥ 4.                                                               c
c                                                                                                 c
c  By considering the sum of FITs generated by the BOPs (indicated in red above),                 c
c  we obtain 1 + 15 + 58 = 74.                                                                    c
c                                                                                                 c
c  Consider the following tenth degree polynomial generating function:                            c
c                                                                                                 c
c  u_n = 1 − n + n^2 − n^3 + n^4 − n^5 + n^6 − n^7 + n^8 − n^9 + n^10                             c
c                                                                                                 c
c  Find the sum of FITs for the BOPs.                                                             c
c                                                                                                 c
c-------------------------------------------------------------------------------------------------c
      implicit none
      include 'euler.inc'

c parameters used in this program only
      integer*8 series(11), BOPs(11), result
      
c get the series numbers
      do x1=1,11
        series(x1) = 1-x1+x1**2-x1**3+x1**4-x1**5+x1**6-x1**7+x1**8-x1**9+x1**10
        write(*,*) x1, series(x1)
        BOPs(x1) = 0
      enddo
      
c we already know that the BOP for the constant series is going to be series(1) = 1
      BOPs(1) = series(1)
      
c linear using the first two terms of the sequence, BOP appears at n=3
      BOPs(2) = series(1)*(3-2)/(1-2) + series(2)*(3-1)/(2-1)
      
c quadratic using the first three terms of the sequence, BOP appears at n=4
      BOPs(3) = series(1)*(4-2)*(4-3)/((1-2)*(1-3)) + series(2)*(4-1)*(4-3)/((2-1)*(2-3)) + series(3)*(4-1)*(4-2)/((3-1)*(3-2))
      
c cubic using the first four terms of the sequence, BOP appears at n=5
      BOPs(4) = series(1)*(5-2)*(5-3)*(5-4)/((1-2)*(1-3)*(1-4)) + series(2)*(5-1)*(5-3)*(5-4)/((2-1)*(2-3)*(2-4))
     .        + series(3)*(5-1)*(5-2)*(5-4)/((3-1)*(3-2)*(3-4)) + series(4)*(5-1)*(5-2)*(5-3)/((4-1)*(4-2)*(4-3))

c quartic using the first five terms of the sequence, BOP appears at n=6
      BOPs(5) = series(1)*(6-2)*(6-3)*(6-4)*(6-5)/((1-2)*(1-3)*(1-4)*(1-5))
     .        + series(2)*(6-1)*(6-3)*(6-4)*(6-5)/((2-1)*(2-3)*(2-4)*(2-5))
     .        + series(3)*(6-1)*(6-2)*(6-4)*(6-5)/((3-1)*(3-2)*(3-4)*(3-5))
     .        + series(4)*(6-1)*(6-2)*(6-3)*(6-5)/((4-1)*(4-2)*(4-3)*(4-5))
     .        + series(5)*(6-1)*(6-2)*(6-3)*(6-4)/((5-1)*(5-2)*(5-3)*(5-4))

c k=5 using 6 terms, BOP appears at n=7
      BOPs(6) = series(1)*(7-2)*(7-3)*(7-4)*(7-5)*(7-6)/((1-2)*(1-3)*(1-4)*(1-5)*(1-6))
     .        + series(2)*(7-1)*(7-3)*(7-4)*(7-5)*(7-6)/((2-1)*(2-3)*(2-4)*(2-5)*(2-6))
     .        + series(3)*(7-1)*(7-2)*(7-4)*(7-5)*(7-6)/((3-1)*(3-2)*(3-4)*(3-5)*(3-6))
     .        + series(4)*(7-1)*(7-2)*(7-3)*(7-5)*(7-6)/((4-1)*(4-2)*(4-3)*(4-5)*(4-6))
     .        + series(5)*(7-1)*(7-2)*(7-3)*(7-4)*(7-6)/((5-1)*(5-2)*(5-3)*(5-4)*(5-6))
     .        + series(6)*(7-1)*(7-2)*(7-3)*(7-4)*(7-5)/((6-1)*(6-2)*(6-3)*(6-4)*(6-5))

c k=6 using 7 terms, BOP appears at n=8
      BOPs(7) = series(1)*(8-2)*(8-3)*(8-4)*(8-5)*(8-6)*(8-7)/((1-2)*(1-3)*(1-4)*(1-5)*(1-6)*(1-7))
     .        + series(2)*(8-1)*(8-3)*(8-4)*(8-5)*(8-6)*(8-7)/((2-1)*(2-3)*(2-4)*(2-5)*(2-6)*(2-7))
     .        + series(3)*(8-1)*(8-2)*(8-4)*(8-5)*(8-6)*(8-7)/((3-1)*(3-2)*(3-4)*(3-5)*(3-6)*(3-7))
     .        + series(4)*(8-1)*(8-2)*(8-3)*(8-5)*(8-6)*(8-7)/((4-1)*(4-2)*(4-3)*(4-5)*(4-6)*(4-7))
     .        + series(5)*(8-1)*(8-2)*(8-3)*(8-4)*(8-6)*(8-7)/((5-1)*(5-2)*(5-3)*(5-4)*(5-6)*(5-7))
     .        + series(6)*(8-1)*(8-2)*(8-3)*(8-4)*(8-5)*(8-7)/((6-1)*(6-2)*(6-3)*(6-4)*(6-5)*(6-7))
     .        + series(7)*(8-1)*(8-2)*(8-3)*(8-4)*(8-5)*(8-6)/((7-1)*(7-2)*(7-3)*(7-4)*(7-5)*(7-6))

c k=7 using 8 terms, BOP appears at n=9
      BOPs(8) = series(1)*(9-2)*(9-3)*(9-4)*(9-5)*(9-6)*(9-7)*(9-8)/((1-2)*(1-3)*(1-4)*(1-5)*(1-6)*(1-7)*(1-8))
     .        + series(2)*(9-1)*(9-3)*(9-4)*(9-5)*(9-6)*(9-7)*(9-8)/((2-1)*(2-3)*(2-4)*(2-5)*(2-6)*(2-7)*(2-8))
     .        + series(3)*(9-1)*(9-2)*(9-4)*(9-5)*(9-6)*(9-7)*(9-8)/((3-1)*(3-2)*(3-4)*(3-5)*(3-6)*(3-7)*(3-8))
     .        + series(4)*(9-1)*(9-2)*(9-3)*(9-5)*(9-6)*(9-7)*(9-8)/((4-1)*(4-2)*(4-3)*(4-5)*(4-6)*(4-7)*(4-8))
     .        + series(5)*(9-1)*(9-2)*(9-3)*(9-4)*(9-6)*(9-7)*(9-8)/((5-1)*(5-2)*(5-3)*(5-4)*(5-6)*(5-7)*(5-8))
     .        + series(6)*(9-1)*(9-2)*(9-3)*(9-4)*(9-5)*(9-7)*(9-8)/((6-1)*(6-2)*(6-3)*(6-4)*(6-5)*(6-7)*(6-8))
     .        + series(7)*(9-1)*(9-2)*(9-3)*(9-4)*(9-5)*(9-6)*(9-8)/((7-1)*(7-2)*(7-3)*(7-4)*(7-5)*(7-6)*(7-8))
     .        + series(8)*(9-1)*(9-2)*(9-3)*(9-4)*(9-5)*(9-6)*(9-7)/((8-1)*(8-2)*(8-3)*(8-4)*(8-5)*(8-6)*(8-7))

c k=8 using 9 terms, BOP appears at n=10
      BOPs(9) = series(1)*(10-2)*(10-3)*(10-4)*(10-5)*(10-6)*(10-7)*(10-8)*(10-9)
     .        /((1-2)*(1-3)*(1-4)*(1-5)*(1-6)*(1-7)*(1-8)*(1-9))
     .        + series(2)*(10-1)*(10-3)*(10-4)*(10-5)*(10-6)*(10-7)*(10-8)*(10-9)
     .        /((2-1)*(2-3)*(2-4)*(2-5)*(2-6)*(2-7)*(2-8)*(2-9))
     .        + series(3)*(10-1)*(10-2)*(10-4)*(10-5)*(10-6)*(10-7)*(10-8)*(10-9)
     .        /((3-1)*(3-2)*(3-4)*(3-5)*(3-6)*(3-7)*(3-8)*(3-9))
     .        + series(4)*(10-1)*(10-2)*(10-3)*(10-5)*(10-6)*(10-7)*(10-8)*(10-9)
     .        /((4-1)*(4-2)*(4-3)*(4-5)*(4-6)*(4-7)*(4-8)*(4-9))
     .        + series(5)*(10-1)*(10-2)*(10-3)*(10-4)*(10-6)*(10-7)*(10-8)*(10-9)
     .        /((5-1)*(5-2)*(5-3)*(5-4)*(5-6)*(5-7)*(5-8)*(5-9))
     .        + series(6)*(10-1)*(10-2)*(10-3)*(10-4)*(10-5)*(10-7)*(10-8)*(10-9)
     .        /((6-1)*(6-2)*(6-3)*(6-4)*(6-5)*(6-7)*(6-8)*(6-9))
     .        + series(7)*(10-1)*(10-2)*(10-3)*(10-4)*(10-5)*(10-6)*(10-8)*(10-9)
     .        /((7-1)*(7-2)*(7-3)*(7-4)*(7-5)*(7-6)*(7-8)*(7-9))
     .        + series(8)*(10-1)*(10-2)*(10-3)*(10-4)*(10-5)*(10-6)*(10-7)*(10-9)
     .        /((8-1)*(8-2)*(8-3)*(8-4)*(8-5)*(8-6)*(8-7)*(8-9))
     .        + series(9)*(10-1)*(10-2)*(10-3)*(10-4)*(10-5)*(10-6)*(10-7)*(10-8)
     .        /((9-1)*(9-2)*(9-3)*(9-4)*(9-5)*(9-6)*(9-7)*(9-8))

c k=9 using 10 terms, BOP appears at n=11
      BOPs(10) = (11-2)*(11-3)*(11-4)*(11-5)*(11-6)*(11-7)*(11-8)*(11-9)*(11-10)
     .         /((1-2)*(1-3)*(1-4)*(1-5)*(1-6)*(1-7)*(1-8)*(1-9)*(1-10))*series(1)
     .         + (11-1)*(11-3)*(11-4)*(11-5)*(11-6)*(11-7)*(11-8)*(11-9)*(11-10)
     .         /((2-1)*(2-3)*(2-4)*(2-5)*(2-6)*(2-7)*(2-8)*(2-9)*(2-10))*series(2)
     .         + (11-1)*(11-2)*(11-4)*(11-5)*(11-6)*(11-7)*(11-8)*(11-9)*(11-10)
     .         /((3-1)*(3-2)*(3-4)*(3-5)*(3-6)*(3-7)*(3-8)*(3-9)*(3-10))*series(3)
     .         + (11-1)*(11-2)*(11-3)*(11-5)*(11-6)*(11-7)*(11-8)*(11-9)*(11-10)
     .         /((4-1)*(4-2)*(4-3)*(4-5)*(4-6)*(4-7)*(4-8)*(4-9)*(4-10))*series(4)
     .         + (11-1)*(11-2)*(11-3)*(11-4)*(11-6)*(11-7)*(11-8)*(11-9)*(11-10)
     .         /((5-1)*(5-2)*(5-3)*(5-4)*(5-6)*(5-7)*(5-8)*(5-9)*(5-10))*series(5)
     .         + (11-1)*(11-2)*(11-3)*(11-4)*(11-5)*(11-7)*(11-8)*(11-9)*(11-10)
     .         /((6-1)*(6-2)*(6-3)*(6-4)*(6-5)*(6-7)*(6-8)*(6-9)*(6-10))*series(6)
     .         + (11-1)*(11-2)*(11-3)*(11-4)*(11-5)*(11-6)*(11-8)*(11-9)*(11-10)
     .         /((7-1)*(7-2)*(7-3)*(7-4)*(7-5)*(7-6)*(7-8)*(7-9)*(7-10))*series(7)
     .         + (11-1)*(11-2)*(11-3)*(11-4)*(11-5)*(11-6)*(11-7)*(11-9)*(11-10)
     .         /((8-1)*(8-2)*(8-3)*(8-4)*(8-5)*(8-6)*(8-7)*(8-9)*(8-10))*series(8)
     .         + (11-1)*(11-2)*(11-3)*(11-4)*(11-5)*(11-6)*(11-7)*(11-8)*(11-10)
     .         /((9-1)*(9-2)*(9-3)*(9-4)*(9-5)*(9-6)*(9-7)*(9-8)*(9-10))*series(9)
     .         + (11-1)*(11-2)*(11-3)*(11-4)*(11-5)*(11-6)*(11-7)*(11-8)*(11-9)
     .         /((10-1)*(10-2)*(10-3)*(10-4)*(10-5)*(10-6)*(10-7)*(10-8)*(10-9))*series(10)

c k=10 using 11 terms, BOP appears at n=12
      BOPs(11) = (12-2)*(12-3)*(12-4)*(12-5)*(12-6)*(12-7)*(12-8)*(12-9)*(12-10)*(12-11)
     .         /((1-2)*(1-3)*(1-4)*(1-5)*(1-6)*(1-7)*(1-8)*(1-9)*(1-10)*(1-11))*series(1)
     .         + (12-1)*(12-3)*(12-4)*(12-5)*(12-6)*(12-7)*(12-8)*(12-9)*(12-10)*(12-11)
     .         /((2-1)*(2-3)*(2-4)*(2-5)*(2-6)*(2-7)*(2-8)*(2-9)*(2-10)*(2-11))*series(2)
     .         + (12-1)*(12-2)*(12-4)*(12-5)*(12-6)*(12-7)*(12-8)*(12-9)*(12-10)*(12-11)
     .         /((3-1)*(3-2)*(3-4)*(3-5)*(3-6)*(3-7)*(3-8)*(3-9)*(3-10)*(3-11))*series(3)
     .         + (12-1)*(12-2)*(12-3)*(12-5)*(12-6)*(12-7)*(12-8)*(12-9)*(12-10)*(12-11)
     .         /((4-1)*(4-2)*(4-3)*(4-5)*(4-6)*(4-7)*(4-8)*(4-9)*(4-10)*(4-11))*series(4)
     .         + (12-1)*(12-2)*(12-3)*(12-4)*(12-6)*(12-7)*(12-8)*(12-9)*(12-10)*(12-11)
     .         /((5-1)*(5-2)*(5-3)*(5-4)*(5-6)*(5-7)*(5-8)*(5-9)*(5-10)*(5-11))*series(5)
     .         + (12-1)*(12-2)*(12-3)*(12-4)*(12-5)*(12-7)*(12-8)*(12-9)*(12-10)*(12-11)
     .         /((6-1)*(6-2)*(6-3)*(6-4)*(6-5)*(6-7)*(6-8)*(6-9)*(6-10)*(6-11))*series(6)
     .         + (12-1)*(12-2)*(12-3)*(12-4)*(12-5)*(12-6)*(12-8)*(12-9)*(12-10)*(12-11)
     .         /((7-1)*(7-2)*(7-3)*(7-4)*(7-5)*(7-6)*(7-8)*(7-9)*(7-10)*(7-11))*series(7)
     .         + (12-1)*(12-2)*(12-3)*(12-4)*(12-5)*(12-6)*(12-7)*(12-9)*(12-10)*(12-11)
     .         /((8-1)*(8-2)*(8-3)*(8-4)*(8-5)*(8-6)*(8-7)*(8-9)*(8-10)*(8-11))*series(8)
     .         + (12-1)*(12-2)*(12-3)*(12-4)*(12-5)*(12-6)*(12-7)*(12-8)*(12-10)*(12-11)
     .         /((9-1)*(9-2)*(9-3)*(9-4)*(9-5)*(9-6)*(9-7)*(9-8)*(9-10)*(9-11))*series(9)
     .         + (12-1)*(12-2)*(12-3)*(12-4)*(12-5)*(12-6)*(12-7)*(12-8)*(12-9)*(12-11)
     .         /((10-1)*(10-2)*(10-3)*(10-4)*(10-5)*(10-6)*(10-7)*(10-8)*(10-9)*(10-11))*series(10)
     .         + (12-1)*(12-2)*(12-3)*(12-4)*(12-5)*(12-6)*(12-7)*(12-8)*(12-9)*(12-10)
     .         /((11-1)*(11-2)*(11-3)*(11-4)*(11-5)*(11-6)*(11-7)*(11-8)*(11-9)*(11-10))*series(11)
     
c add em up
      result = 0
      do x1=1,10
        result = result + BOPs(x1)
      enddo
      
      write(*,*) 'The result is ',result
      
      end